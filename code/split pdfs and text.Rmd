---
title: "Split PDFs and text"
author: "Rob Wells"
date: "2024-09-06"
output: html_document
---
```{r}
library(tidyverse)
library(pdftools)
#install.packages("pdftools")
```

# Convert PDF to text

Using 10 articles downloaded from NexisUni for Kemi Busari's research
```{r}

text <- pdf_text("../code/split_file/kemi.PDF")
writeLines(text, "../code/split_file/kemi4.txt")
```


# Split text to separate articles on common identifier

In this case, NexisUni makes life easy for us. At the end of each document, there are the words "End of Document". Convenient! We search for "End of Document" and then instruct R to split the file and dump it into a standalone text file.
```{r}
# Step 1: Read the entire text file into R
file_path <- "/Users/robwells/Code/CompText_Jour/code/split_file/kemi4.txt"
text_data <- readLines(file_path)

# Step 2: Combine lines into one single string
text_combined <- paste(text_data, collapse = "\n")

# Step 3: Split the text by the "End of Document" phrase
documents <- strsplit(text_combined, "End of Document")[[1]]

# Step 4: Write each section to a new file
output_dir <- "/Users/robwells/Code/CompText_Jour/code/split_file/"
for (i in seq_along(documents)) {
  output_file <- file.path(output_dir, paste0("test2_document_", i, ".txt"))
  writeLines(documents[[i]], output_file)
}

cat("Files created:", length(documents), "\n")
```

#Part 2: Complex PDFs

### For more complicated PDFs, bring in the Big Guns

```{r}
#Install Required Tools
#Using the system() function to execute a command-line operation directly from within R.
system("brew install tesseract")
system("brew install xpdf")
system("xcode-select --install")
system("brew install libtiff")
system("brew install ghostscript")
system("brew install imagemagick")
```

#Convert PDF to Text
```{r}
#Executes pdftotext, a command-line tool used to convert PDF files to plain text.
system("pdftotext /Users/robwells/Code/CompText_Jour/code/split_file/kemi.PDF ../code/split_file/kemi3.txt")
```


